<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PharmaTrack POS System</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.7.0/fonts/remixicon.css" rel="stylesheet" />

    <style>
        body {
            background: #f8f9fa;
        }

        .navbar-brand i {
            font-size: 24px;
        }

        .card-shadow {
            box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.12);
            border-radius: 12px;
        }

        .pointer {
            cursor: pointer;
        }

        .table tbody tr:hover {
            background: #eef7ff;
        }

        .low-stock {
            background: #fff3cd !important;
        }

        .kpi-box {
            padding: 18px;
            border-radius: 12px;
        }

        .kpi-value {
            font-size: 26px;
            font-weight: bold;
        }

        .kpi-label {
            font-size: 14px;
            opacity: .8;
        }
    </style>
</head>

<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold d-flex align-items-center" href="#">
                <i class="ri-store-2-line text-info me-2"></i> PharmaTrack POS
            </a>
            <span class="text-light small">Signed in as <strong>Pharmacy Owner</strong></span>
        </div>
    </nav>

    <div class="container my-4">

        <!-- KPI ROW -->
        <div class="row g-3 mb-4">

            <div class="col-md-4">
                <div class="card kpi-box card-shadow border-0">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="kpi-value text-primary" id="kpi-products">0</div>
                            <div class="kpi-label">Total Products</div>
                        </div>
                        <i class="ri-medicine-bottle-line text-primary" style="font-size: 32px;"></i>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card kpi-box card-shadow border-0">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="kpi-value text-success" id="kpi-sales">0</div>
                            <div class="kpi-label">Today's Sales</div>
                        </div>
                        <i class="ri-money-dollar-circle-line text-success" style="font-size: 32px;"></i>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card kpi-box card-shadow border-0">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="kpi-value text-danger" id="kpi-low">0</div>
                            <div class="kpi-label">Low Stock</div>
                        </div>
                        <i class="ri-error-warning-line text-danger" style="font-size: 32px;"></i>
                    </div>
                </div>
            </div>

        </div>

        <div class="row g-4">

            <!-- INVENTORY PANEL -->
            <div class="col-lg-7">
                <div class="card card-shadow p-3">

                    <h5 class="fw-bold mb-3">Inventory</h5>

                    <input type="text" id="searchItem" class="form-control mb-3" placeholder="Search products...">

                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>Name</th>
                                <th>Price (Rs)</th>
                                <th>Stock</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTable"></tbody>
                    </table>

                </div>
            </div>

            <!-- BILLING PANEL -->
            <div class="col-lg-5">
                <div class="card card-shadow p-3">

                    <h5 class="fw-bold mb-3">Billing</h5>

                    <table class="table">
                        <thead class="table-light">
                            <tr>
                                <th>Item</th>
                                <th>Qty</th>
                                <th>Subtotal</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="cartTable"></tbody>
                    </table>

                    <hr>

                    <div class="d-flex justify-content-between fw-bold fs-5">
                        <span>Total:</span>
                        <span id="totalAmount">Rs 0.00</span>
                    </div>

                    <button class="btn btn-success w-100 mt-3" id="checkoutBtn">
                        <i class="ri-check-double-line"></i> Checkout
                    </button>

                </div>
            </div>
        </div>

    </div>

    <!-- JS -->
    <script>
        // ====== SAMPLE DATA ======
        let products = [
            { id: 1, name: "Paracetamol", price: 150, stock: 30 },
            { id: 2, name: "Vitamin C", price: 80, stock: 10 },
            { id: 3, name: "Cough Syrup", price: 600, stock: 5 },
            { id: 4, name: "Amoxicillin", price: 250, stock: 8 },
            { id: 5, name: "Pain Relief Gel", price: 300, stock: 2 }
        ];

        let cart = [];

        // ====== LOAD INVENTORY ======
        function loadInventory() {
            const table = document.getElementById("inventoryTable");
            table.innerHTML = "";

            products.forEach(p => {
                let row = `
                    <tr class="${p.stock <= 5 ? 'low-stock' : ''}">
                        <td>${p.name}</td>
                        <td>${p.price}</td>
                        <td>${p.stock}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="addToCart(${p.id})">
                                <i class="ri-add-line"></i>
                            </button>
                        </td>
                    </tr>
                `;
                table.innerHTML += row;
            });

            document.getElementById("kpi-products").innerText = products.length;
            document.getElementById("kpi-low").innerText = products.filter(p => p.stock <= 5).length;
        }

        // ====== SEARCH ======
        document.getElementById("searchItem").addEventListener("input", function () {
            const keyword = this.value.toLowerCase();
            const rows = document.querySelectorAll("#inventoryTable tr");

            rows.forEach(row => {
                row.style.display = row.innerText.toLowerCase().includes(keyword) ? "" : "none";
            });
        });

        // ====== ADD TO CART ======
        function addToCart(id) {
            const product = products.find(p => p.id === id);
            if (!product || product.stock <= 0) return alert("Out of stock!");

            let item = cart.find(c => c.id === id);

            if (item) {
                item.qty++;
            } else {
                cart.push({ id: product.id, name: product.name, price: product.price, qty: 1 });
            }

            product.stock--;
            updateCart();
            loadInventory();
        }

        // ====== UPDATE CART ======
        function updateCart() {
            const table = document.getElementById("cartTable");
            table.innerHTML = "";

            let total = 0;

            cart.forEach(item => {
                let subtotal = item.qty * item.price;
                total += subtotal;

                let row = `
                    <tr>
                        <td>${item.name}</td>
                        <td>
                            <input type="number" min="1" value="${item.qty}" class="form-control form-control-sm"
                                onchange="changeQty(${item.id}, this.value)">
                        </td>
                        <td>Rs ${subtotal}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="removeItem(${item.id})">
                                <i class="ri-delete-bin-line"></i>
                            </button>
                        </td>
                    </tr>
                `;
                table.innerHTML += row;
            });

            document.getElementById("totalAmount").innerText = `Rs ${total}`;
            document.getElementById("kpi-sales").innerText = total;
        }

        // ====== CHANGE QUANTITY ======
        function changeQty(id, newQty) {
            let item = cart.find(c => c.id === id);
            if (!item) return;

            newQty = parseInt(newQty);
            if (newQty <= 0) return;

            const product = products.find(p => p.id === id);

            if (newQty > item.qty) {
                // increasing qty
                if (product.stock <= 0) return alert("No more stock available!");
                product.stock--;
            } else {
                // decreasing qty
                product.stock++;
            }

            item.qty = newQty;

            updateCart();
            loadInventory();
        }

        // ====== REMOVE ITEM ======
        function removeItem(id) {
            const item = cart.find(c => c.id === id);
            const product = products.find(p => p.id === id);

            if (item) {
                product.stock += item.qty;
            }

            cart = cart.filter(c => c.id !== id);

            updateCart();
            loadInventory();
        }

        // ====== CHECKOUT ======
        document.getElementById("checkoutBtn").addEventListener("click", function () {
            if (cart.length === 0) return alert("Cart is empty!");

            alert("Payment Successful!");
            cart = [];
            updateCart();
        });

        loadInventory();
    </script>

</body>

</html>